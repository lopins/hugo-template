<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Huabing Blog"><meta property="og:type" content="article"><meta property="og:image" content="https://images.unsplash.com/photo-1561562176-d1d598e49589?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1470&amp;q=80"><meta property="twitter:image" content="https://images.unsplash.com/photo-1561562176-d1d598e49589?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1470&amp;q=80"><meta name=title content="Aeraki Mesh"><meta property="og:title" content="Aeraki Mesh"><meta property="twitter:title" content="Aeraki Mesh"><meta name=description content="Aeraki [Air-rah-ki] is the Greek word for 'breeze'. While Istio connects microservices in a service mesh, Aeraki provides a framework to allow Istio to support more layer 7 protocols other than just HTTP and gRPC. We hope that this breeze can help Istio sail a little further."><meta property="og:description" content="Aeraki [Air-rah-ki] is the Greek word for 'breeze'. While Istio connects microservices in a service mesh, Aeraki provides a framework to allow Istio to support more layer 7 protocols other than just HTTP and gRPC. We hope that this breeze can help Istio sail a little further."><meta property="twitter:description" content="Aeraki [Air-rah-ki] is the Greek word for 'breeze'. While Istio connects microservices in a service mesh, Aeraki provides a framework to allow Istio to support more layer 7 protocols other than just HTTP and gRPC. We hope that this breeze can help Istio sail a little further."><meta property="twitter:card" content="summary"><meta name=keyword content="赵化冰, zhaohuabing, Zhaohuabing, , 赵化冰的网络日志, 赵化冰的博客, Zhaohuabing Blog, 博客, 个人网站, 互联网, Web, 云原生, PaaS, Istio, Kubernetes, 微服务, Microservice"><link rel="shortcut icon" href=/hugo-template/img/favicon.ico><title>Aeraki Mesh | 赵化冰的博客 | Zhaohuabing Blog</title>
<link rel=canonical href=/hugo-template/post/2021-09-27-aeraki/><link rel=stylesheet href=/hugo-template/css/bootstrap.min.css><link rel=stylesheet href=/hugo-template/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/hugo-template/css/zanshang.css><link rel=stylesheet href=/hugo-template/css/font-awesome.all.min.css><script src=/hugo-template/js/jquery.min.js></script><script src=/hugo-template/js/bootstrap.min.js></script><script src=/hugo-template/js/hux-blog.min.js></script><script src=/hugo-template/js/lazysizes.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=/>Huabing Blog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/hugo-template/categories/books/>books</a></li><li><a href=/hugo-template/categories/open-source/>open source</a></li><li><a href=/hugo-template/categories/presentations/>presentations</a></li><li><a href=/hugo-template/categories/tech/>tech</a></li><li><a href=/archive//>ARCHIVE</a></li><li><a href=/notes//>NOTES</a></li><li><a href=/about//>ABOUT</a></li><li><a href=/hugo-template/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(https://images.unsplash.com/photo-1561562176-d1d598e49589?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1470&q=80)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/istio title=Istio>Istio
</a><a class=tag href=/tags/service-mesh title="Service Mesh">Service Mesh
</a><a class=tag href=/tags/envoy title=Envoy>Envoy
</a><a class=tag href=/tags/aeraki title=Aeraki>Aeraki</a></div><h1>Aeraki Mesh</h1><h2 class=subheading>Manage Any Layer-7 Protocol in Istio Service Mesh!</h2><span class=meta><a href=https://www.aeraki.net>Website</a>
<a href=https://github.com/aeraki-mesh>Github</a>
<a href="http://aeraki.zhaohuabing.com:3000/d/pgz7wp-Gz/aeraki-demo?orgId=1&amp;refresh=10s&amp;kiosk">Online demo</a></span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>Aeraki [Air-rah-ki] Mesh is an open-source service mesh I started about a year ago, and have been working on it till recently. Aeraki is the Greek word for ‘breeze’. While Istio connects microservices in a service mesh, Aeraki Mesh provides a non-intrusive, highly extendable way to allow Istio to support none-HTTP open-source and proprietary protocols. I hope this breeze can help Istio and service mesh sail a little further.</p><h2 id=lack-of-protocols-support-in-service-mesh>Lack of Protocols Support in Service Mesh</h2><p>We are now facing some challenges with service meshes:</p><ul><li>Istio and other popular service mesh implementations have very limited support for layer 7 protocols other than HTTP and gRPC.</li><li>Envoy RDS(Route Discovery Service) is solely designed for HTTP. Other protocols such as Dubbo and Thrift can only use listener in-line routes for traffic management, which breaks existing connections when routes change.</li><li>It takes a lot of effort to introduce a proprietary protocol into a service mesh. You’ll need to write an Envoy filter to handle the traffic in the data plane, and a control plane to manage those Envoys.</li></ul><p>Those obstacles make it very hard, if not impossible, for users to manage the traffic of other widely-used layer-7 protocols in microservices. For example, in a microservices application, we may have the below protocols:</p><ul><li>RPC: HTTP, gRPC, Thrift, Dubbo, Proprietary RPC Protocol …</li><li>Messaging: Kafka, RabbitMQ …</li><li>Cache: Redis, Memcached …</li><li>Database: MySQL, PostgreSQL, MongoDB …</li></ul><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/protocols.png alt=" Common Layer-7 Protocols Used in Microservices  "></p><p>If you have already invested a lot of effort in migrating to a service mesh, of course, you want to get the most out of it — managing the traffic of all the protocols in your microservices.</p><h2 id=aeraki-meshs-approach>Aeraki Mesh’s Approach</h2><p>To address these problems, I created the open-source project, <a href=https://github.com/aeraki-mesh>Aeraki Mesh</a>, to provide a non-intrusive, extendable way to manage any layer 7 traffic in an Istio service mesh.</p><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/aeraki-architecture.png alt=" Aeraki Mesh Architecture "></p><p>As this diagram shows, Aeraki Framework consists of the following components:</p><ul><li>Aeraki: <a href=https://github.com/aeraki-mesh/aeraki>Aeraki</a> provides high-level, user-friendly traffic management rules to operations, translates the rules to envoy filter configurations, and leverages Istio’s <code>EnvoyFilter</code> API to push the configurations to the sidecar proxies. Aeraki also serves as the RDS server for MetaProtocol proxies in the data plane. Contrary to Envoy RDS, which focuses on HTTP, Aeraki RDS is aimed to provide a general dynamic route capability for all layer-7 protocols.</li><li>MetaProtocol Proxy: <a href=https://github.com/aeraki-mesh/meta-protocol-proxy>MetaProtocol Proxy</a> provides common capabilities for Layer-7 protocols, such as load balancing, circuit breaker, load balancing, routing, rate limiting, fault injection, and auth. Layer-7 protocols can be built on top of MetaProtocol. To add a new protocol into the service mesh, the only thing you need to do is implementing the <a href=https://github.com/aeraki-mesh/meta-protocol-proxy/blob/ac788327239bd794e745ce18b382da858ddf3355/src/meta_protocol_proxy/codec/codec.h#L118>codec interface</a> and a couple of lines of configuration. If you have special requirements which can’t be accommodated by the built-in capabilities, MetaProtocol Proxy also has an application-level filter chain mechanism, allowing users to write their own layer-7 filters to add custom logic into MetaProtocol Proxy.</li></ul><p><a href=https://github.com/aeraki-mesh/meta-protocol-proxy/tree/master/src/application_protocols/dubbo>Dubbo</a> and <a href=https://github.com/aeraki-mesh/meta-protocol-proxy/tree/master/src/application_protocols/thrift>Thrift</a> have already been implemented based on MetaProtocol. More protocols are on the way. If you&rsquo;re using a close-source, proprietary protocol, you can also manage it in your service mesh simply by writing a MetaProtocol codec for it.</p><p>Most request/response style, stateless protocols can be built on top of the MetaProtocol Proxy. However, some protocols&rsquo; routing policies are too &ldquo;special&rdquo; to be normalized in MetaProtocol. For example, Redis proxy uses a slot number to map a client query to a specific Redis server node, and the slot number is computed by the key in the request. Aeraki can still manage those protocols as long as there&rsquo;s an available Envoy Filter in the Envoy proxy side. Currently, for protocols in this category, <a href=https://github.com/aeraki-mesh/aeraki/blob/master/docs/zh/redis.md>Redis</a> and Kafka are supported in Aeraki.</p><h2 id=deep-dive-into-metaprotocol>Deep Dive Into MetaProtocol</h2><p>Let’s look into how MetaProtocol works. Before MetaProtocol is introduced, if we want to proxy traffic for a specific protocol, we need to write an Envoy filter that understands that protocol and add the code to manipulate the traffic, including routing, header modification, fault injection, traffic mirroring, etc.</p><p>For most request/response style protocols, the code for traffic manipulation is very similar. Therefore, to avoid duplicating these functionalities in different Envoy filters, Aeraki Framework implements most of the common functions of a layer-7 protocol proxy in a single place — the MetaProtocol Proxy filter.</p><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/metaprotocol-proxy.png alt="MetaProtocol Proxy"></p><p>This approach significantly lowers the barrier to write a new Envoy filter: instead of writing a fully functional filter, now you only need to implement the codec interface. In addition to that, the control plane is already in place — Aeraki works at the control plane to provides MetaProtocol configuration and dynamic routes for all protocols built on top of MetaProtocol.</p><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/metaprotocol-proxy-codec.png alt="Writing an Envoy Filter Before and After MetProtocol"></p><p>There are two important data structures in MetaProtocol Proxy: Metadata and Mutation. Metadata is used for routing, and Mutation is used for header manipulation.</p><p>At the request path, the decoder(the decode method of the codec implementation) populates the Metadata data structure with key-value pairs parsed from the request, then the Metadata will be passed to the MetaProtocol Router. The Router selects an appropriate upstream cluster after matching the route configuration it receives from Aeraki via RDS and the Metadata.</p><p>A custom filter can populate the Mutation data structure with arbitrary key-value pairs if the request needs to be modified: adding a header or changing the value of a header. Then the Mutation data structure will be passed to the encoder(the encode method of the codec implementation). The encoder is responsible for writing the key-value pairs into the wire protocol.</p><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/request-path.png alt="Request Path"></p><p>The response path is similar to the request path, only in a different direction.</p><p><img src=https://zhaohuabing.com/static/img/2021-09-27-aeraki/response-path.png alt="Response Path"></p><h2 id=an-example>An Example</h2><p>If you need to implement an application protocol based on MetaProtocol, you can follow the below steps(use Dubbo as an example):</p><h3 id=data-plane>Data Plane</h3><ul><li><p>Implement the <a href=https://github.com/aeraki-mesh/meta-protocol-proxy/blob/ac788327239bd794e745ce18b382da858ddf3355/src/meta_protocol_proxy/codec/codec.h#L118>codec interface</a> to encode and decode the protocol package. You can refer to <a href=https://github.com/aeraki-mesh/meta-protocol-proxy/tree/master/src/application_protocols/dubbo>Dubbo codec</a> and <a href=https://github.com/aeraki-mesh/meta-protocol-proxy/tree/master/src/application_protocols/thrift>Thrift codec</a> as writing your own implementation.</p></li><li><p>Define the protocol with Aeraki <code>ApplicationProtocol</code> CRD, as this YAML snippet shows:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ff79c6>apiVersion</span>: metaprotocol.aeraki.io/v1alpha1
</span></span><span style=display:flex><span><span style=color:#ff79c6>kind</span>: ApplicationProtocol
</span></span><span style=display:flex><span><span style=color:#ff79c6>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>name</span>: dubbo
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>namespace</span>: istio-system
</span></span><span style=display:flex><span><span style=color:#ff79c6>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>protocol</span>: dubbo
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>codec</span>: aeraki.meta_protocol.codec.dubbo
</span></span></code></pre></div><h3 id=control-plane>Control Plane</h3><p>You don’t need to implement the control plane. Aeraki watches services and traffic rules, generates the configurations for the sidecar proxies, and sends the configurations to the data plane via <code>EnvoyFilter</code> and MetaProtocol RDS.</p><h3 id=protocol-selection>Protocol selection</h3><p>Similar to Istio, protocols are identified by service port prefix. Please name service ports with this pattern: tcp-metaprotocol-{application protocol}-xxx. For example, a Dubbo service port should be named tcp-metaprotocol-dubbo.</p><h3 id=traffic-management>Traffic management</h3><p>You can change the route via <code>MataRouter</code> CRD.</p><ul><li>Route the Dubbo requests calling method sayHello to v2:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ff79c6>apiVersion</span>: metaprotocol.aeraki.io/v1alpha1
</span></span><span style=display:flex><span><span style=color:#ff79c6>kind</span>: MetaRouter
</span></span><span style=display:flex><span><span style=color:#ff79c6>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>name</span>: test-metaprotocol-route
</span></span><span style=display:flex><span><span style=color:#ff79c6>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>hosts</span>:
</span></span><span style=display:flex><span>    - org.apache.dubbo.samples.basic.api.demoservice
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>routes</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: v2
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>match</span>:
</span></span><span style=display:flex><span>        <span style=color:#ff79c6>attributes</span>:
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>method</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>exact</span>: sayHello
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>route</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ff79c6>destination</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>host</span>: org.apache.dubbo.samples.basic.api.demoservice
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>subset</span>: v2
</span></span></code></pre></div><ul><li>Send 20% of the requests to v1 and 80% to v2:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ff79c6>piVersion</span>: metaprotocol.aeraki.io/v1alpha1
</span></span><span style=display:flex><span><span style=color:#ff79c6>kind</span>: MetaRouter
</span></span><span style=display:flex><span><span style=color:#ff79c6>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>name</span>: test-metaprotocol-route
</span></span><span style=display:flex><span><span style=color:#ff79c6>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>hosts</span>:
</span></span><span style=display:flex><span>    - org.apache.dubbo.samples.basic.api.demoservice
</span></span><span style=display:flex><span>  <span style=color:#ff79c6>routes</span>:
</span></span><span style=display:flex><span>    - <span style=color:#ff79c6>name</span>: traffic-spilt
</span></span><span style=display:flex><span>      <span style=color:#ff79c6>route</span>:
</span></span><span style=display:flex><span>        - <span style=color:#ff79c6>destination</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>host</span>: org.apache.dubbo.samples.basic.api.demoservice
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>subset</span>: v1
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>weight</span>: <span style=color:#bd93f9>20</span>
</span></span><span style=display:flex><span>        - <span style=color:#ff79c6>destination</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>host</span>: org.apache.dubbo.samples.basic.api.demoservice
</span></span><span style=display:flex><span>            <span style=color:#ff79c6>subset</span>: v2
</span></span><span style=display:flex><span>          <span style=color:#ff79c6>weight</span>: <span style=color:#bd93f9>80</span>
</span></span></code></pre></div><h2 id=demo>Demo</h2><p><a href=http://aeraki.zhaohuabing.com:20001/>Live Demo: kiali Dashboard</a></p><p><a href="http://aeraki.zhaohuabing.com:3000/d/pgz7wp-Gz/aeraki-demo?orgId=1&amp;refresh=10s&amp;kiosk">Live Demo: Service Metrics: Grafana</a></p><p><a href="http://aeraki.zhaohuabing.com:9090/new/graph?g0.expr=envoy_dubbo_inbound_20880___response_success&amp;g0.tab=0&amp;g0.stacked=1&amp;g0.range_input=1h&amp;g1.expr=envoy_dubbo_outbound_20880__org_apache_dubbo_samples_basic_api_demoservice_request&amp;g1.tab=0&amp;g1.stacked=1&amp;g1.range_input=1h&amp;g2.expr=envoy_thrift_inbound_9090___response&amp;g2.tab=0&amp;g2.stacked=1&amp;g2.range_input=1h&amp;g3.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_response_success&amp;g3.tab=0&amp;g3.stacked=1&amp;g3.range_input=1h&amp;g4.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_request&amp;g4.tab=0&amp;g4.stacked=1&amp;g4.range_input=1h">Live Demo: Service Metrics: Prometheus</a></p><p>Screenshot: Service Metrics:
<img src=https://raw.githubusercontent.com/aeraki-mesh/aeraki/master/docs/metrics.png alt="Screenshot: Service Metrics"></p><p>Recored Demo: Dubbo and Thrift Traffic Management
<a href="https://www.youtube.com/watch?v=vrjp-Yg3Leg"><img src=http://i3.ytimg.com/vi/vrjp-Yg3Leg/maxresdefault.jpg alt="Thrift and Dubbo traffic management demo"></a></p><h2 id=install>Install</h2><h3 id=pre-requirements>Pre-requirements:</h3><ul><li>A running Kubernetes cluster, which can be either a cluster in the cloud, or a local cluster created with kind/minikube</li><li>Kubectl installed, and the <code>~/.kube/conf</code> points to the cluster in the first step</li><li>Helm installed, which will be used to install some components in the demo</li></ul><h3 id=download-aeraki-from-the-github>Download Aeraki from the Github</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/aeraki-mesh/aeraki.git
</span></span></code></pre></div><h3 id=install-istio-aeraki-and-demo-applications>Install Istio, Aeraki and demo applications</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aeraki/demo/install-demo.sh
</span></span></code></pre></div><p>Note: Aeraki needs to configure Istio with smart dns. If you already have an Istio installed and don&rsquo;t know how to
turn on smart dns, please uninstall it. install-demo.sh will install Istio for you.</p><h3 id=open-the-following-urls-in-your-browser-to-play-with-aeraki-and-view-service-metrics>Open the following URLs in your browser to play with Aeraki and view service metrics</h3><ul><li>Kaili <code>http://{istio-ingressgateway_external_ip}:20001</code></li><li>Grafana <code>http://{istio-ingressgateway_external_ip}:3000</code></li><li>Prometheus <code>http://{istio-ingressgateway_external_ip}:9090</code></li></ul><p>You can import Aeraika demo dashboard from file <code>demo/aeraki-demo.json</code> into the Grafana.</p><h2 id=talks>Talks</h2><ul><li>Istio meetup China(中文): <a href="https://www.youtube.com/watch?v=Bq5T3OR3iTM">全栈服务网格 - Aeraki 助你在 Istio 服务网格中管理任何七层流量</a></li><li>IstioCon 2021: <a href="https://www.youtube.com/watch?v=sBS4utF68d8">How to Manage Any Layer-7 Traffic in an Istio Service Mesh?</a></li></ul><h2 id=contact>Contact</h2><ul><li>Mail: If you&rsquo;re interested in contributing to this project, please reach out to <a href=mailto:zhaohuabing@gmail.com>zhaohuabing@gmail.com</a></li><li>Wechat Group: Please contact Wechat ID: zhao_huabing to join the Aeraki Wechat group</li><li>Slack: Join <a href=http://aeraki.slack.com/>Aeraki slack channel</a></li></ul><h2 id=reference>Reference</h2><ul><li><a href=%22https://www.aeraki.net%22>Aeraki Mesh Website</a></li><li><a href=https://github.com/aeraki-mesh>Aeraki Mesh GitHub</a></li><li><a href=http://aeraki.zhaohuabing.com:20001/>Live Demo: Kiali Dashboard</a></li><li><a href="http://aeraki.zhaohuabing.com:3000/d/pgz7wp-Gz/aeraki-demo?orgId=1&amp;refresh=10s&amp;kiosk">Live Demo: Service Metrics: Grafana</a></li><li><a href="http://aeraki.zhaohuabing.com:9090/new/graph?g0.expr=envoy_dubbo_inbound_20880___response_success&amp;g0.tab=0&amp;g0.stacked=1&amp;g0.range_input=1h&amp;g1.expr=envoy_dubbo_outbound_20880__org_apache_dubbo_samples_basic_api_demoservice_request&amp;g1.tab=0&amp;g1.stacked=1&amp;g1.range_input=1h&amp;g2.expr=envoy_thrift_inbound_9090___response&amp;g2.tab=0&amp;g2.stacked=1&amp;g2.range_input=1h&amp;g3.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_response_success&amp;g3.tab=0&amp;g3.stacked=1&amp;g3.range_input=1h&amp;g4.expr=envoy_thrift_outbound_9090__thrift_sample_server_thrift_svc_cluster_local_request&amp;g4.tab=0&amp;g4.stacked=1&amp;g4.range_input=1h">Live Demo: Service Metrics: Prometheus</a></li><li>Istio meetup China(Chinese): <a href="https://www.youtube.com/watch?v=Bq5T3OR3iTM">Full Stack Service Mesh - Manage Any Layer-7 Traffic in an Istio Service Mesh with Aeraki</a></li><li>IstioCon 2021: <a href="https://www.youtube.com/watch?v=sBS4utF68d8">How to Manage Any Layer-7 Traffic in an Istio Service Mesh?</a></li></ul><div class="entry-shang text-center"><p>「真诚赞赏，手留余香」</p><button class="zs show-zs btn btn-bred">赞赏支持</button></div><div class=zs-modal-bg></div><div class=zs-modal-box><div class=zs-modal-head><button type=button class=close>×</button>
<span class=author><a href=https://lopins.github.io/hugo-template/><img src=/hugo-template/img/favicon.png>Huabing Blog</a></span><p class=tip><i></i><span>真诚赞赏，手留余香</span></p></div><div class=zs-modal-body><div class=zs-modal-btns><button class="btn btn-blink" data-num=2>2元</button>
<button class="btn btn-blink" data-num=5>5元</button>
<button class="btn btn-blink" data-num=10>10元</button>
<button class="btn btn-blink" data-num=50>50元</button>
<button class="btn btn-blink" data-num=100>100元</button>
<button class="btn btn-blink" data-num=1>任意金额</button></div><div class=zs-modal-pay><button class="btn btn-bred" id=pay-text>2元</button><p>使用<span id=pay-type>微信</span>扫描二维码完成支付</p><img src=/hugo-template/img/reward/wechat-2.png id=pay-image></div></div><div class=zs-modal-footer><label><input type=radio name=zs-type value=wechat class=zs-type checked><span><span class=zs-wechat><img src=/hugo-template/img/reward/wechat-btn.png></span></label>
<label><input type=radio name=zs-type value=alipay class=zs-type class=zs-alipay><img src=/hugo-template/img/reward/alipay-btn.png></span></label></div></div><script type=text/javascript src=/hugo-template/js/reward.js></script><hr><ul class=pager><li class=previous><a href=/hugo-template/post/2021-10-08-istio-operation-bible/ data-toggle=tooltip data-placement=top title="Istio 运维实战（电子书）">&larr;
Previous Post</a></li><li class=next><a href=/hugo-template/post/2021-12-19-ebpf-for-service-mesh/ data-toggle=tooltip data-placement=top title="译文：服务网格将使用 eBPF ？是的，但 Envoy 代理将继续存在">Next
Post &rarr;</a></li></ul><link href=https://xxx.xxx.com/dist/Artalk.css rel=stylesheet><script src=https://xxx.xxx.com/dist/Artalk.js></script><div id=Comments></div><script>Artalk.init({el:"#Comments",pageKey:"https://lopins.github.io/hugo-template/post/2021-09-27-aeraki/",pageTitle:"Aeraki Mesh",server:"https://xxx.xxx.com",site:"xxx blog"})</script></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/aeraki title=aeraki>aeraki
</a><a href=/tags/aeraki-mesh title="aeraki mesh">aeraki mesh
</a><a href=/tags/ambient-mesh title="ambient mesh">ambient mesh
</a><a href=/tags/api-gateway title="api gateway">api gateway
</a><a href=/tags/bitcoin title=bitcoin>bitcoin
</a><a href=/tags/blockchain title=blockchain>blockchain
</a><a href=/tags/cka title=cka>cka
</a><a href=/tags/cncf title=cncf>cncf
</a><a href=/tags/cryptocurrency title=cryptocurrency>cryptocurrency
</a><a href=/tags/digital-signature title="digital signature">digital signature
</a><a href=/tags/docker title=docker>docker
</a><a href=/tags/dubbo title=dubbo>dubbo
</a><a href=/tags/envoy title=envoy>envoy
</a><a href=/tags/envoy-gateway title="envoy gateway">envoy gateway
</a><a href=/tags/ingress title=ingress>ingress
</a><a href=/tags/istio title=istio>istio
</a><a href=/tags/jaeger title=jaeger>jaeger
</a><a href=/tags/kafka title=kafka>kafka
</a><a href=/tags/knowledge-graph title="knowledge graph">knowledge graph
</a><a href=/tags/kubecon title=kubecon>kubecon
</a><a href=/tags/kubernetes title=kubernetes>kubernetes
</a><a href=/tags/linux title=linux>linux
</a><a href=/tags/loadbalancer title=loadbalancer>loadbalancer
</a><a href=/tags/metaprotocol title=metaprotocol>metaprotocol
</a><a href=/tags/microservice title=microservice>microservice
</a><a href=/tags/network title=network>network
</a><a href=/tags/network-service-mesh title="network service mesh">network service mesh
</a><a href=/tags/nfv title=nfv>nfv
</a><a href=/tags/nodeport title=nodeport>nodeport
</a><a href=/tags/onap title=onap>onap
</a><a href=/tags/opentracing title=opentracing>opentracing
</a><a href=/tags/pilot title=pilot>pilot
</a><a href=/tags/proxy-protocol title="proxy protocol">proxy protocol
</a><a href=/tags/redis title=redis>redis
</a><a href=/tags/sdn title=sdn>sdn
</a><a href=/tags/security title=security>security
</a><a href=/tags/service-mesh title="service mesh">service mesh
</a><a href=/tags/tencent title=tencent>tencent
</a><a href=/tags/x-forwarded-for title=x-forwarded-for>x-forwarded-for</a></div></section><section><hr><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://zhaozhihan.com>Linda的博客</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:youremail@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=/hugo-template/your%20wechat%20qr%20code%20image><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-weixin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/yourgithub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/yourlinkedinid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://stackoverflow.com/users/yourstackoverflowid><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="Huabing Blog"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Huabing Blog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/hugo-template/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>